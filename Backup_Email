# Script para Backup do Mikrotik


# altere abaixo o token e id

# token do bot do telegram
:global token="000000000:0000000000000-0000000000000000000000000000000"

# ID do grupo ou usuário do telegram
:global chatid="-1234567890123"



# não alterar mais nada abaixo
# exceto por sua conta e risco

# envia uma mensagem de log do início do backup
:log warning "Iniciando backup por e-mail"

# aguarda 3 segundos
:delay 3s


# salvando o backup dentro do mikrotik
/system backup save name=backup_e-mail.backup

# aguarda 3 segundos
:delay 3s


# salvando o export em um arquivo dentro do mikrotik
/export file=backup_e-mail

# aguarda 3 segundos
:delay 3s


# envia uma mensagem de log de criação do backup
:log warning "Backup criado com sucesso!"

# aguarda 2 segundos
:delay 2s


# variáveis para data hora e nome
:global data [/system clock get date]
:global hora [/system clock get time]
:global nome [/system identity get name]

# aguarda 1 segundo
:delay 1s


# comando que envia o e-mail apenas do arquivo do export.
/tool e-mail send to="seu-email@gmail.com" subject="Backup do Servidor $nome - $data às $hora" body="Backup automático do servidor $nome realizado às $hora de $data." file=backup_e-mail.rsc

# aguarda 3 segundos
:delay 3s

# envia uma mensagem de log do envio do backup pelo email
:log warning "Backup enviado para o Email com sucesso!"

# aguarda 3 segundos
:delay 3s

# envia backup para o telegram
/tool fetch url="https://api.telegram.org/bot$token/sendMessage?chat_id=$chatid&text=Backup do Servidor $nome - $data às $hora"

# aguarda 3 segundos
:delay 3s

# envia uma mensagem de log do envio do backup pelo telegram
:log warning "Backup enviado para o Telegram com sucesso!"

# aguarda 3 segundos
:delay 3s

# envia uma mensagem de log de finalização do envio do backup
:log warning message="Backup Enviado com sucesso!"